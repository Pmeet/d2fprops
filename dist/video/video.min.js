"use strict";var d2f_video=(()=>{var M=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var G=Object.prototype.hasOwnProperty;var K=(e,t)=>{for(var n in t)M(e,n,{get:t[n],enumerable:!0})},B=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of F(t))!G.call(e,i)&&i!==n&&M(e,i,{get:()=>t[i],enumerable:!(o=U(t,i))||o.enumerable});return e};var N=e=>B(M({},"__esModule",{value:!0}),e);var ie={};K(ie,{getYouTubeId:()=>A,init:()=>P,isVideoFileUrl:()=>O,isYouTubeUrl:()=>L,parseRatioToPaddingTop:()=>k,pickBestYouTubePoster:()=>Y});var c={ROOT:"data-vdo",SRC:"data-vdo-src",MODE:"data-vdo-mode",AUTOPLAY:"data-vdo-autoplay",MUTED:"data-vdo-muted",RATIO:"data-vdo-ratio",POSTER:"data-vdo-poster",PLAY_TOGGLE:"data-vdo-play-toggle",HAS_RATIO:"data-vdo-has-ratio"},m={ROOT:"data-video",SRC:"data-video-src",MODE:"data-video-mode",AUTOPLAY:"data-video-autoplay",MUTED:"data-video-muted",RATIO:"data-video-ratio",POSTER:"data-video-poster",PLAY_TOGGLE:"data-video-play-toggle",HAS_RATIO:"data-video-has-ratio"};function y(e,t,n){return e.getAttribute(t)??e.getAttribute(n)}var H="https://www.youtube-nocookie.com",r="d2f-video",p=null,E=null;function L(e){return/youtu\.be|youtube\.com/i.test(e||"")}function O(e){return/\.(mp4|webm|m4v)(\?.*)?$/i.test(e||"")}function A(e){if(!e)return null;let t=e.replace(/watch\?v=([^&?]+)\?/i,"watch?v=$1&"),n=[/(?:youtube\.com\/watch\?v=)([^&]+)/i,/(?:youtu\.be\/)([^?&]+)/i,/(?:youtube\.com\/embed\/)([^?&]+)/i,/[?&]v=([^&]+)/i];for(let o of n){let i=t.match(o);if(i&&i[1])return i[1]}return null}function k(e){if(!e||!e.includes("/"))return null;let[t,n]=e.split("/").map(o=>parseFloat(String(o).trim()));return!t||!n?null:`${n/t*100}%`}function j(e,t=2500){return new Promise(n=>{let o=new Image,i=!1,l=g=>{i||(i=!0,o.onload=null,o.onerror=null,n(g))},s=setTimeout(()=>l(!1),t);o.onload=()=>{clearTimeout(s),l(!0)},o.onerror=()=>{clearTimeout(s),l(!1)},o.src=e})}async function Y(e){let t=[`https://i.ytimg.com/vi/${e}/maxresdefault.jpg`,`https://i.ytimg.com/vi/${e}/sddefault.jpg`,`https://i.ytimg.com/vi/${e}/hqdefault.jpg`];for(let n of t)if(await j(n))return n;return t[t.length-1]}async function W(e,t){let n=y(e,m.POSTER,c.POSTER);if(n){e.style.backgroundImage=`url("${n}")`;return}if(!L(t))return;let o=A(t);if(!o||e.style.backgroundImage&&e.style.backgroundImage!=="none")return;let i=await Y(o);e.style.backgroundImage=`url("${i}")`}function b(e,t){e.querySelectorAll(`[${c.PLAY_TOGGLE}], [${m.PLAY_TOGGLE}]`).forEach(o=>{o.style.opacity=t?"0":"1",o.style.pointerEvents=t?"none":"",o.style.transition="opacity 0.25s ease"})}function T(){let e=document.querySelector(`.${r}-modal`);return e||(e=document.createElement("div"),e.className=`${r}-modal`,e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.setAttribute("aria-label","Video dialog"),e.innerHTML=`
    <button class="${r}-modal__close" type="button" aria-label="Close video">
      <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
        <path fill="currentColor" d="M18.3 5.71 12 12l6.3 6.29-1.41 1.42L10.59 13.4 4.29 19.71 2.88 18.3 9.17 12 2.88 5.71 4.29 4.29l6.3 6.31 6.3-6.31z"/>
      </svg>
    </button>
    <div class="${r}-modal__panel" role="document">
      <div class="${r}-modal__ratio">
        <div class="${r}-modal__inner"></div>
      </div>
    </div>
  `,document.body.appendChild(e),e)}function _(e){if(p){try{p.destroy()}catch{}p=null}e&&(e.innerHTML="")}function h(){let e=document.querySelector(`.${r}-modal`);if(!e)return;let t=e.querySelector(`.${r}-modal__inner`);_(t),e.classList.remove("is-open"),document.documentElement.style.overflow="",document.body.style.overflow="",e._onKey&&(document.removeEventListener("keydown",e._onKey),e._onKey=void 0),E&&(te(E),typeof E.focus=="function"&&E.focus())}function R(){let e=T();e.classList.add("is-open"),document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",e.querySelector(`.${r}-modal__close`)?.focus();let n=o=>{o.key==="Escape"&&h()};e._onKey=n,document.addEventListener("keydown",n)}function z(){let e=T(),t=e.querySelector(`.${r}-modal__panel`),n=e.querySelector(`.${r}-modal__close`);n?.addEventListener("click",h),e.addEventListener("click",o=>{t&&!t.contains(o.target)&&o.target!==n&&h()})}function J(e,t){let n=A(e);if(!n)return null;let o=new URLSearchParams({autoplay:t?"1":"0",rel:"0",playsinline:"1",modestbranding:"1"}),i=document.createElement("iframe");return i.src=`${H}/embed/${n}?${o.toString()}`,i.setAttribute("title","YouTube video"),i.setAttribute("allow","autoplay; fullscreen; picture-in-picture"),i.setAttribute("allowfullscreen","true"),i.setAttribute("frameborder","0"),i.loading="lazy",i}function V(e,t,n){let o=document.createElement("video");o.setAttribute("playsinline",""),o.setAttribute("controls",""),o.autoplay=t,o.muted=n;let i=document.createElement("source");return i.src=e,i.type=/\.webm(\?.*)?$/i.test(e)?"video/webm":"video/mp4",o.appendChild(i),o}function X(e){let t=A(e);if(!t)return null;let n=typeof window<"u"?window.location.origin:"",o=new URLSearchParams({autoplay:"1",mute:"1",loop:"1",playlist:t,controls:"0",modestbranding:"1",playsinline:"1",rel:"0",showinfo:"0",disablekb:"1",enablejsapi:"1",origin:n,iv_load_policy:"3",fs:"0",cc_load_policy:"0"}),i=document.createElement("iframe");return i.src=`${H}/embed/${t}?${o.toString()}`,i.setAttribute("title","Video preview"),i.setAttribute("allow","autoplay; fullscreen; picture-in-picture"),i.setAttribute("allowfullscreen","true"),i.setAttribute("frameborder","0"),i.loading="eager",i.style.pointerEvents="none",i}function Q(e){let t=document.createElement("video");t.setAttribute("playsinline",""),t.autoplay=!0,t.muted=!0,t.loop=!0,t.style.pointerEvents="none";let n=document.createElement("source");return n.src=e,n.type=/\.webm(\?.*)?$/i.test(e)?"video/webm":"video/mp4",t.appendChild(n),t}function C(e){try{window.Plyr&&(p=new window.Plyr(e,{controls:["play-large","play","progress","current-time","mute","volume","settings","fullscreen"]}))}catch{p=null}}function Z(e,t,n){if(L(t)){let o=X(t);o&&(n.appendChild(o),e._d2fPreviewEl=o,b(e,!0))}else if(O(t)){let o=Q(t);n.appendChild(o),e._d2fPreviewEl=o,b(e,!0),setTimeout(()=>{try{o.play()}catch{}},0)}}function q(e,t){e.contentWindow&&e.contentWindow.postMessage(JSON.stringify({event:"command",func:t,args:""}),H)}function ee(e){let t=e._d2fPreviewEl;t&&(t instanceof HTMLVideoElement?t.pause():t instanceof HTMLIFrameElement&&q(t,"pauseVideo"))}function te(e){let t=e._d2fPreviewEl;if(t)if(t instanceof HTMLVideoElement)try{t.play()}catch{}else t instanceof HTMLIFrameElement&&q(t,"playVideo")}function oe(e,t,n){let o=new IntersectionObserver(i=>{for(let l of i)if(l.isIntersecting){Z(e,t,n),o.disconnect();return}},{rootMargin:"-5% 0px 0px 0px",threshold:0});o.observe(e)}function ne(e){if(e._d2fVideoInit)return;e._d2fVideoInit=!0;let t=y(e,m.SRC,c.SRC);if(!t)return;let o=e.hasAttribute(c.ROOT)?c:m,i=y(e,m.RATIO,c.RATIO),l=k(i);if(l&&(e.style.setProperty("--d2f-video-pt",l),e.setAttribute(o.HAS_RATIO,"1")),W(e,t),!e.querySelector(`.${r}__inner`)){let d=document.createElement("div");d.className=`${r}__inner`,e.appendChild(d)}let s=(y(e,m.MODE,c.MODE)||"modal").toLowerCase(),g=(y(e,m.AUTOPLAY,c.AUTOPLAY)||"1")==="1",$=(y(e,m.MUTED,c.MUTED)||"0")==="1";e.hasAttribute("tabindex")||e.setAttribute("tabindex","0"),e.hasAttribute("role")||e.setAttribute("role","button"),e.hasAttribute("aria-label")||e.setAttribute("aria-label",s==="preview"?"Play full video":"Play video");let w=e.querySelector(`.${r}__inner`);s==="preview"&&oe(e,t,w);let I=d=>{d&&(d.preventDefault(),d.stopPropagation()),E=e,s==="preview"?ee(e):w.innerHTML="";let S=s==="preview"?!0:g,x=s==="preview"?!1:$;if(L(t)){let a=J(t,S);if(!a)return;if(s==="inline"){w.appendChild(a),b(e,!0);try{window.Plyr&&(p=new window.Plyr(a))}catch{}}else{let v=T(),f=v.querySelector(`.${r}-modal__inner`);_(f);let u=v.querySelector(`.${r}-modal__ratio`);u&&(l?(u.style.setProperty("--d2f-video-pt",l),u.setAttribute("data-video-has-ratio","1")):(u.style.removeProperty("--d2f-video-pt"),u.removeAttribute("data-video-has-ratio"))),f?.appendChild(a);try{window.Plyr&&(p=new window.Plyr(a))}catch{}R()}return}if(O(t))if(s==="inline"){let a=V(t,g,$);w.appendChild(a),b(e,!0),a.addEventListener("ended",()=>b(e,!1),{once:!0}),C(a),setTimeout(()=>{try{a.play()}catch{}},0)}else{let a=T(),v=a.querySelector(`.${r}-modal__inner`);_(v);let f=a.querySelector(`.${r}-modal__ratio`);f&&(l?(f.style.setProperty("--d2f-video-pt",l),f.setAttribute("data-video-has-ratio","1")):(f.style.removeProperty("--d2f-video-pt"),f.removeAttribute("data-video-has-ratio")));let u=V(t,S,x);v?.appendChild(u),C(u),setTimeout(()=>{try{u.play()}catch{}},0),R()}};e.addEventListener("click",I),e.addEventListener("keydown",d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),I(d))})}function P(){T(),z(),document.querySelectorAll(`[${c.ROOT}], [${m.ROOT}]`).forEach(ne)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",P):P();return N(ie);})();
