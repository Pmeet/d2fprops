{
  "version": 3,
  "sources": ["../../src/props/video/index.ts"],
  "sourcesContent": ["/**\n * d2fprops / video\n * Attribute-based video player for Webflow\n *\n * Supports two attribute naming conventions:\n * - Legacy: data-vdo, data-vdo-src, etc. (for existing implementations)\n * - New: data-video, data-video-src, etc.\n *\n * @example\n * <div data-vdo data-vdo-src=\"https://youtube.com/watch?v=VIDEO_ID\"></div>\n * <div data-video data-video-src=\"https://youtube.com/watch?v=VIDEO_ID\"></div>\n */\n\n// ============================================================\n// CONSTANTS\n// ============================================================\n\n// Legacy attributes (data-vdo-*) - maintained for backwards compatibility\nconst ATTR_LEGACY = {\n  ROOT: \"data-vdo\",\n  SRC: \"data-vdo-src\",\n  MODE: \"data-vdo-mode\",\n  AUTOPLAY: \"data-vdo-autoplay\",\n  MUTED: \"data-vdo-muted\",\n  RATIO: \"data-vdo-ratio\",\n  POSTER: \"data-vdo-poster\",\n  PLAY_TOGGLE: \"data-vdo-play-toggle\",\n  HAS_RATIO: \"data-vdo-has-ratio\",\n} as const;\n\n// New attributes (data-video-*)\nconst ATTR_NEW = {\n  ROOT: \"data-video\",\n  SRC: \"data-video-src\",\n  MODE: \"data-video-mode\",\n  AUTOPLAY: \"data-video-autoplay\",\n  MUTED: \"data-video-muted\",\n  RATIO: \"data-video-ratio\",\n  POSTER: \"data-video-poster\",\n  PLAY_TOGGLE: \"data-video-play-toggle\",\n  HAS_RATIO: \"data-video-has-ratio\",\n} as const;\n\n/**\n * Get attribute value with fallback to legacy naming\n */\nfunction getAttr(el: HTMLElement, newAttr: string, legacyAttr: string): string | null {\n  return el.getAttribute(newAttr) ?? el.getAttribute(legacyAttr);\n}\n\nconst YT_PRIVACY_DOMAIN = \"https://www.youtube-nocookie.com\";\nconst CSS_PREFIX = \"d2f-video\";\n\n// ============================================================\n// TYPE DEFINITIONS\n// ============================================================\n\ninterface VideoElement extends HTMLElement {\n  _d2fVideoInit?: boolean;\n  _d2fPreviewEl?: HTMLVideoElement | HTMLIFrameElement;\n}\n\ninterface VideoModal extends HTMLElement {\n  _onKey?: (ev: KeyboardEvent) => void;\n}\n\ndeclare global {\n  interface Window {\n    Plyr?: new (element: HTMLElement | HTMLIFrameElement, options?: object) => PlyrInstance;\n  }\n}\n\ninterface PlyrInstance {\n  destroy(): void;\n}\n\n// ============================================================\n// STATE\n// ============================================================\n\nlet activePlayer: PlyrInstance | null = null;\nlet lastActiveEl: HTMLElement | null = null;\n\n// ============================================================\n// URL HELPERS\n// ============================================================\n\n/**\n * Check if URL is a YouTube link\n */\nexport function isYouTubeUrl(url: string | null): boolean {\n  return /youtu\\.be|youtube\\.com/i.test(url || \"\");\n}\n\n/**\n * Check if URL is a direct video file\n */\nexport function isVideoFileUrl(url: string | null): boolean {\n  return /\\.(mp4|webm|m4v)(\\?.*)?$/i.test(url || \"\");\n}\n\n/**\n * Extract YouTube video ID from various URL formats\n */\nexport function getYouTubeId(url: string | null): string | null {\n  if (!url) return null;\n\n  // Clean up malformed URLs\n  const cleaned = url.replace(/watch\\?v=([^&?]+)\\?/i, \"watch?v=$1&\");\n\n  const patterns = [\n    /(?:youtube\\.com\\/watch\\?v=)([^&]+)/i,\n    /(?:youtu\\.be\\/)([^?&]+)/i,\n    /(?:youtube\\.com\\/embed\\/)([^?&]+)/i,\n    /[?&]v=([^&]+)/i,\n  ];\n\n  for (const re of patterns) {\n    const m = cleaned.match(re);\n    if (m && m[1]) return m[1];\n  }\n\n  return null;\n}\n\n// ============================================================\n// RATIO HELPERS\n// ============================================================\n\n/**\n * Convert ratio string (e.g., \"16/9\") to CSS padding-top percentage\n */\nexport function parseRatioToPaddingTop(ratioStr: string | null): string | null {\n  if (!ratioStr || !ratioStr.includes(\"/\")) return null;\n\n  const [w, h] = ratioStr.split(\"/\").map((n) => parseFloat(String(n).trim()));\n  if (!w || !h) return null;\n\n  return `${(h / w) * 100}%`;\n}\n\n// ============================================================\n// POSTER HELPERS\n// ============================================================\n\n/**\n * Test if an image URL can be loaded\n */\nfunction canLoadImage(url: string, timeoutMs = 2500): Promise<boolean> {\n  return new Promise((resolve) => {\n    const img = new Image();\n    let done = false;\n\n    const finish = (ok: boolean) => {\n      if (done) return;\n      done = true;\n      img.onload = null;\n      img.onerror = null;\n      resolve(ok);\n    };\n\n    const t = setTimeout(() => finish(false), timeoutMs);\n    img.onload = () => {\n      clearTimeout(t);\n      finish(true);\n    };\n    img.onerror = () => {\n      clearTimeout(t);\n      finish(false);\n    };\n    img.src = url;\n  });\n}\n\n/**\n * Find the best available YouTube thumbnail\n */\nexport async function pickBestYouTubePoster(ytId: string): Promise<string> {\n  const candidates = [\n    `https://i.ytimg.com/vi/${ytId}/maxresdefault.jpg`,\n    `https://i.ytimg.com/vi/${ytId}/sddefault.jpg`,\n    `https://i.ytimg.com/vi/${ytId}/hqdefault.jpg`,\n  ];\n\n  for (const url of candidates) {\n    const ok = await canLoadImage(url);\n    if (ok) return url;\n  }\n\n  return candidates[candidates.length - 1];\n}\n\n/**\n * Set poster image on element if not already set\n */\nasync function setPosterIfNeeded(el: HTMLElement, src: string): Promise<void> {\n  // Explicit poster attribute takes priority (check both naming conventions)\n  const custom = getAttr(el, ATTR_NEW.POSTER, ATTR_LEGACY.POSTER);\n  if (custom) {\n    el.style.backgroundImage = `url(\"${custom}\")`;\n    return;\n  }\n\n  if (!isYouTubeUrl(src)) return;\n\n  const id = getYouTubeId(src);\n  if (!id) return;\n\n  // Don't override existing inline styles\n  if (el.style.backgroundImage && el.style.backgroundImage !== \"none\") return;\n\n  const best = await pickBestYouTubePoster(id);\n  el.style.backgroundImage = `url(\"${best}\")`;\n}\n\n// ============================================================\n// UI HELPERS\n// ============================================================\n\n/**\n * Toggle visibility of play overlay elements\n */\nfunction togglePlayOverlay(rootEl: HTMLElement, isPlaying: boolean): void {\n  // Check both legacy and new attribute names\n  const toggles = rootEl.querySelectorAll<HTMLElement>(\n    `[${ATTR_LEGACY.PLAY_TOGGLE}], [${ATTR_NEW.PLAY_TOGGLE}]`\n  );\n\n  toggles.forEach((el) => {\n    el.style.opacity = isPlaying ? \"0\" : \"1\";\n    el.style.pointerEvents = isPlaying ? \"none\" : \"\";\n    el.style.transition = \"opacity 0.25s ease\";\n  });\n}\n\n// ============================================================\n// MODAL\n// ============================================================\n\n/**\n * Get or create the modal element\n */\nfunction ensureModal(): VideoModal {\n  let modal = document.querySelector<VideoModal>(`.${CSS_PREFIX}-modal`);\n  if (modal) return modal;\n\n  modal = document.createElement(\"div\") as VideoModal;\n  modal.className = `${CSS_PREFIX}-modal`;\n  modal.setAttribute(\"role\", \"dialog\");\n  modal.setAttribute(\"aria-modal\", \"true\");\n  modal.setAttribute(\"aria-label\", \"Video dialog\");\n\n  modal.innerHTML = `\n    <button class=\"${CSS_PREFIX}-modal__close\" type=\"button\" aria-label=\"Close video\">\n      <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n        <path fill=\"currentColor\" d=\"M18.3 5.71 12 12l6.3 6.29-1.41 1.42L10.59 13.4 4.29 19.71 2.88 18.3 9.17 12 2.88 5.71 4.29 4.29l6.3 6.31 6.3-6.31z\"/>\n      </svg>\n    </button>\n    <div class=\"${CSS_PREFIX}-modal__panel\" role=\"document\">\n      <div class=\"${CSS_PREFIX}-modal__ratio\">\n        <div class=\"${CSS_PREFIX}-modal__inner\"></div>\n      </div>\n    </div>\n  `;\n\n  document.body.appendChild(modal);\n  return modal;\n}\n\n/**\n * Destroy active player and clear container\n */\nfunction destroyPlayerAndClear(container: HTMLElement | null): void {\n  if (activePlayer) {\n    try {\n      activePlayer.destroy();\n    } catch (e) {\n      // Ignore destroy errors\n    }\n    activePlayer = null;\n  }\n  if (container) container.innerHTML = \"\";\n}\n\n/**\n * Close the video modal\n */\nfunction closeModal(): void {\n  const modal = document.querySelector<VideoModal>(`.${CSS_PREFIX}-modal`);\n  if (!modal) return;\n\n  const inner = modal.querySelector<HTMLElement>(`.${CSS_PREFIX}-modal__inner`);\n  destroyPlayerAndClear(inner);\n\n  modal.classList.remove(\"is-open\");\n  document.documentElement.style.overflow = \"\";\n  document.body.style.overflow = \"\";\n\n  if (modal._onKey) {\n    document.removeEventListener(\"keydown\", modal._onKey);\n    modal._onKey = undefined;\n  }\n\n  if (lastActiveEl) {\n    // Resume preview if the element that opened the modal was in preview mode\n    resumePreview(lastActiveEl as VideoElement);\n    if (typeof lastActiveEl.focus === \"function\") {\n      lastActiveEl.focus();\n    }\n  }\n}\n\n/**\n * Open the video modal\n */\nfunction openModal(): void {\n  const modal = ensureModal();\n  modal.classList.add(\"is-open\");\n  document.documentElement.style.overflow = \"hidden\";\n  document.body.style.overflow = \"hidden\";\n\n  const closeBtn = modal.querySelector<HTMLButtonElement>(`.${CSS_PREFIX}-modal__close`);\n  closeBtn?.focus();\n\n  const onKey = (ev: KeyboardEvent) => {\n    if (ev.key === \"Escape\") closeModal();\n  };\n  modal._onKey = onKey;\n  document.addEventListener(\"keydown\", onKey);\n}\n\n/**\n * Wire up modal close handlers\n */\nfunction wireModalClose(): void {\n  const modal = ensureModal();\n  const panel = modal.querySelector<HTMLElement>(`.${CSS_PREFIX}-modal__panel`);\n  const closeBtn = modal.querySelector<HTMLButtonElement>(`.${CSS_PREFIX}-modal__close`);\n\n  closeBtn?.addEventListener(\"click\", closeModal);\n\n  modal.addEventListener(\"click\", (e) => {\n    if (panel && !panel.contains(e.target as Node) && e.target !== closeBtn) {\n      closeModal();\n    }\n  });\n}\n\n// ============================================================\n// PLAYER BUILDERS\n// ============================================================\n\n/**\n * Create a YouTube iframe embed\n */\nfunction buildYouTubeIframe(src: string, autoplay: boolean): HTMLIFrameElement | null {\n  const id = getYouTubeId(src);\n  if (!id) return null;\n\n  const params = new URLSearchParams({\n    autoplay: autoplay ? \"1\" : \"0\",\n    rel: \"0\",\n    playsinline: \"1\",\n    modestbranding: \"1\",\n  });\n\n  const iframe = document.createElement(\"iframe\");\n  iframe.src = `${YT_PRIVACY_DOMAIN}/embed/${id}?${params.toString()}`;\n  iframe.setAttribute(\"title\", \"YouTube video\");\n  iframe.setAttribute(\"allow\", \"autoplay; fullscreen; picture-in-picture\");\n  iframe.setAttribute(\"allowfullscreen\", \"true\");\n  iframe.setAttribute(\"frameborder\", \"0\");\n  iframe.loading = \"lazy\";\n\n  return iframe;\n}\n\n/**\n * Create an HTML5 video element\n */\nfunction buildHtml5Video(src: string, autoplay: boolean, muted: boolean): HTMLVideoElement {\n  const video = document.createElement(\"video\");\n  video.setAttribute(\"playsinline\", \"\");\n  video.setAttribute(\"controls\", \"\");\n  video.autoplay = autoplay;\n  video.muted = muted;\n\n  const source = document.createElement(\"source\");\n  source.src = src;\n  source.type = /\\.webm(\\?.*)?$/i.test(src) ? \"video/webm\" : \"video/mp4\";\n  video.appendChild(source);\n\n  return video;\n}\n\n/**\n * Create a YouTube iframe for muted, looping preview playback (no controls)\n */\nfunction buildPreviewYouTubeIframe(src: string): HTMLIFrameElement | null {\n  const id = getYouTubeId(src);\n  if (!id) return null;\n\n  const pageOrigin = typeof window !== \"undefined\" ? window.location.origin : \"\";\n  const params = new URLSearchParams({\n    autoplay: \"1\",\n    mute: \"1\",\n    loop: \"1\",\n    playlist: id,\n    controls: \"0\",\n    modestbranding: \"1\",\n    playsinline: \"1\",\n    rel: \"0\",\n    showinfo: \"0\",\n    disablekb: \"1\",\n    enablejsapi: \"1\",\n    origin: pageOrigin,\n    iv_load_policy: \"3\",\n    fs: \"0\",\n    cc_load_policy: \"0\",\n  });\n\n  const iframe = document.createElement(\"iframe\");\n  iframe.src = `${YT_PRIVACY_DOMAIN}/embed/${id}?${params.toString()}`;\n  iframe.setAttribute(\"title\", \"Video preview\");\n  iframe.setAttribute(\"allow\", \"autoplay; fullscreen; picture-in-picture\");\n  iframe.setAttribute(\"allowfullscreen\", \"true\");\n  iframe.setAttribute(\"frameborder\", \"0\");\n  iframe.loading = \"eager\";\n  iframe.style.pointerEvents = \"none\";\n\n  return iframe;\n}\n\n/**\n * Create an HTML5 video element for muted, looping preview playback (no controls)\n */\nfunction buildPreviewHtml5Video(src: string): HTMLVideoElement {\n  const video = document.createElement(\"video\");\n  video.setAttribute(\"playsinline\", \"\");\n  video.autoplay = true;\n  video.muted = true;\n  video.loop = true;\n  video.style.pointerEvents = \"none\";\n\n  const source = document.createElement(\"source\");\n  source.src = src;\n  source.type = /\\.webm(\\?.*)?$/i.test(src) ? \"video/webm\" : \"video/mp4\";\n  video.appendChild(source);\n\n  return video;\n}\n\n/**\n * Enhance a video/iframe with Plyr if available\n */\nfunction enhanceWithPlyr(mediaEl: HTMLVideoElement | HTMLIFrameElement): void {\n  try {\n    if (window.Plyr) {\n      activePlayer = new window.Plyr(mediaEl, {\n        controls: [\n          \"play-large\",\n          \"play\",\n          \"progress\",\n          \"current-time\",\n          \"mute\",\n          \"volume\",\n          \"settings\",\n          \"fullscreen\",\n        ],\n      });\n    }\n  } catch (e) {\n    activePlayer = null;\n  }\n}\n\n// ============================================================\n// PREVIEW MODE\n// ============================================================\n\n/**\n * Mount and start a muted, looping preview player inside the element\n */\nfunction startPreview(el: VideoElement, src: string, inner: HTMLElement): void {\n  if (isYouTubeUrl(src)) {\n    const iframe = buildPreviewYouTubeIframe(src);\n    if (iframe) {\n      inner.appendChild(iframe);\n      el._d2fPreviewEl = iframe;\n      togglePlayOverlay(el, true);\n    }\n  } else if (isVideoFileUrl(src)) {\n    const vid = buildPreviewHtml5Video(src);\n    inner.appendChild(vid);\n    el._d2fPreviewEl = vid;\n    togglePlayOverlay(el, true);\n    setTimeout(() => {\n      try { vid.play(); } catch (_e) { /* autoplay may be blocked */ }\n    }, 0);\n  }\n}\n\n/**\n * Send a command to a YouTube iframe via postMessage\n */\nfunction ytCommand(iframe: HTMLIFrameElement, func: string): void {\n  if (!iframe.contentWindow) return;\n  iframe.contentWindow.postMessage(\n    JSON.stringify({ event: \"command\", func, args: \"\" }),\n    YT_PRIVACY_DOMAIN\n  );\n}\n\n/**\n * Pause the preview player (called when modal opens)\n */\nfunction pausePreview(el: VideoElement): void {\n  const preview = el._d2fPreviewEl;\n  if (!preview) return;\n\n  if (preview instanceof HTMLVideoElement) {\n    preview.pause();\n  } else if (preview instanceof HTMLIFrameElement) {\n    ytCommand(preview, \"pauseVideo\");\n  }\n}\n\n/**\n * Resume the preview player (called when modal closes)\n */\nfunction resumePreview(el: VideoElement): void {\n  const preview = el._d2fPreviewEl;\n  if (!preview) return;\n\n  if (preview instanceof HTMLVideoElement) {\n    try { preview.play(); } catch (_e) { /* ignore */ }\n  } else if (preview instanceof HTMLIFrameElement) {\n    ytCommand(preview, \"playVideo\");\n  }\n}\n\n/**\n * Observe element visibility and start preview when ~5% visible from viewport top\n */\nfunction observePreview(el: HTMLElement, src: string, inner: HTMLElement): void {\n  const observer = new IntersectionObserver(\n    (entries) => {\n      for (const entry of entries) {\n        if (entry.isIntersecting) {\n          startPreview(el, src, inner);\n          observer.disconnect();\n          return;\n        }\n      }\n    },\n    { rootMargin: \"-5% 0px 0px 0px\", threshold: 0 }\n  );\n  observer.observe(el);\n}\n\n// ============================================================\n// INITIALIZATION\n// ============================================================\n\n/**\n * Initialize a single video element\n */\nfunction initOne(el: VideoElement): void {\n  // Prevent double initialization\n  if (el._d2fVideoInit) return;\n  el._d2fVideoInit = true;\n\n  // Get src with fallback to legacy attribute\n  const src = getAttr(el, ATTR_NEW.SRC, ATTR_LEGACY.SRC);\n  if (!src) return;\n\n  // Determine which attribute set this element uses (for setting attributes)\n  const isLegacy = el.hasAttribute(ATTR_LEGACY.ROOT);\n  const ATTR = isLegacy ? ATTR_LEGACY : ATTR_NEW;\n\n  // Set up aspect ratio\n  const ratioStr = getAttr(el, ATTR_NEW.RATIO, ATTR_LEGACY.RATIO);\n  const pt = parseRatioToPaddingTop(ratioStr);\n  if (pt) {\n    el.style.setProperty(\"--d2f-video-pt\", pt);\n    el.setAttribute(ATTR.HAS_RATIO, \"1\");\n  }\n\n  // Set poster (async for YouTube)\n  setPosterIfNeeded(el, src);\n\n  // Create inner mount (use consistent class name internally)\n  if (!el.querySelector(`.${CSS_PREFIX}__inner`)) {\n    const inner = document.createElement(\"div\");\n    inner.className = `${CSS_PREFIX}__inner`;\n    el.appendChild(inner);\n  }\n\n  // Parse options with fallback to legacy attributes\n  const mode = (getAttr(el, ATTR_NEW.MODE, ATTR_LEGACY.MODE) || \"modal\").toLowerCase();\n  const autoplay = (getAttr(el, ATTR_NEW.AUTOPLAY, ATTR_LEGACY.AUTOPLAY) || \"1\") === \"1\";\n  const muted = (getAttr(el, ATTR_NEW.MUTED, ATTR_LEGACY.MUTED) || \"0\") === \"1\";\n\n  // Accessibility\n  if (!el.hasAttribute(\"tabindex\")) el.setAttribute(\"tabindex\", \"0\");\n  if (!el.hasAttribute(\"role\")) el.setAttribute(\"role\", \"button\");\n  if (!el.hasAttribute(\"aria-label\")) {\n    el.setAttribute(\"aria-label\", mode === \"preview\" ? \"Play full video\" : \"Play video\");\n  }\n\n  const inner = el.querySelector<HTMLElement>(`.${CSS_PREFIX}__inner`)!;\n\n  // Preview mode: set up IntersectionObserver to start preview when scrolled into view\n  if (mode === \"preview\") {\n    observePreview(el, src, inner);\n  }\n\n  /**\n   * Play handler\n   */\n  const play = (e?: Event) => {\n    if (e) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n    lastActiveEl = el;\n\n    // In preview mode, pause the preview and keep it in the DOM (don't clear inner)\n    if (mode === \"preview\") {\n      pausePreview(el);\n    } else {\n      inner.innerHTML = \"\";\n    }\n\n    // For preview mode, modal player always starts unmuted with autoplay from 0:00\n    const modalAutoplay = mode === \"preview\" ? true : autoplay;\n    const modalMuted = mode === \"preview\" ? false : muted;\n\n    // YouTube video\n    if (isYouTubeUrl(src)) {\n      const iframe = buildYouTubeIframe(src, modalAutoplay);\n      if (!iframe) return;\n\n      if (mode === \"inline\") {\n        inner.appendChild(iframe);\n        togglePlayOverlay(el, true);\n        try {\n          if (window.Plyr) activePlayer = new window.Plyr(iframe);\n        } catch (e) {\n          // Ignore Plyr errors\n        }\n      } else {\n        const modal = ensureModal();\n        const modalInner = modal.querySelector<HTMLElement>(`.${CSS_PREFIX}-modal__inner`);\n        destroyPlayerAndClear(modalInner);\n\n        const modalRatio = modal.querySelector<HTMLElement>(`.${CSS_PREFIX}-modal__ratio`);\n        if (modalRatio) {\n          if (pt) {\n            modalRatio.style.setProperty(\"--d2f-video-pt\", pt);\n            modalRatio.setAttribute(\"data-video-has-ratio\", \"1\");\n          } else {\n            modalRatio.style.removeProperty(\"--d2f-video-pt\");\n            modalRatio.removeAttribute(\"data-video-has-ratio\");\n          }\n        }\n\n        modalInner?.appendChild(iframe);\n        try {\n          if (window.Plyr) activePlayer = new window.Plyr(iframe);\n        } catch (e) {\n          // Ignore Plyr errors\n        }\n        openModal();\n      }\n      return;\n    }\n\n    // Direct video file\n    if (isVideoFileUrl(src)) {\n      if (mode === \"inline\") {\n        const vid = buildHtml5Video(src, autoplay, muted);\n        inner.appendChild(vid);\n        togglePlayOverlay(el, true);\n\n        vid.addEventListener(\"ended\", () => togglePlayOverlay(el, false), { once: true });\n\n        enhanceWithPlyr(vid);\n        setTimeout(() => {\n          try {\n            vid.play();\n          } catch (e) {\n            // Ignore play errors\n          }\n        }, 0);\n      } else {\n        const modal = ensureModal();\n        const modalInner = modal.querySelector<HTMLElement>(`.${CSS_PREFIX}-modal__inner`);\n        destroyPlayerAndClear(modalInner);\n\n        const modalRatio = modal.querySelector<HTMLElement>(`.${CSS_PREFIX}-modal__ratio`);\n        if (modalRatio) {\n          if (pt) {\n            modalRatio.style.setProperty(\"--d2f-video-pt\", pt);\n            modalRatio.setAttribute(\"data-video-has-ratio\", \"1\");\n          } else {\n            modalRatio.style.removeProperty(\"--d2f-video-pt\");\n            modalRatio.removeAttribute(\"data-video-has-ratio\");\n          }\n        }\n\n        const vid = buildHtml5Video(src, modalAutoplay, modalMuted);\n        modalInner?.appendChild(vid);\n        enhanceWithPlyr(vid);\n        setTimeout(() => {\n          try {\n            vid.play();\n          } catch (e) {\n            // Ignore play errors\n          }\n        }, 0);\n        openModal();\n      }\n    }\n  };\n\n  // Event listeners\n  el.addEventListener(\"click\", play);\n  el.addEventListener(\"keydown\", (e) => {\n    if (e.key === \"Enter\" || e.key === \" \") {\n      e.preventDefault();\n      play(e);\n    }\n  });\n}\n\n/**\n * Initialize all video elements on the page\n */\nexport function init(): void {\n  ensureModal();\n  wireModalClose();\n  // Select both legacy (data-vdo) and new (data-video) elements\n  document.querySelectorAll<VideoElement>(\n    `[${ATTR_LEGACY.ROOT}], [${ATTR_NEW.ROOT}]`\n  ).forEach(initOne);\n}\n\n// ============================================================\n// AUTO-INIT\n// ============================================================\n\nif (document.readyState === \"loading\") {\n  document.addEventListener(\"DOMContentLoaded\", init);\n} else {\n  init();\n}\n"],
  "mappings": "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",
  "names": ["inner", "e"]
}
